"0","#This code was run only once to retrieve audio features. Output was saved as an RDS object in ""cache/"""
"0",""
"0","# track_id <- bind_cols(track_id = spotify$track_id,"
"0","#                       fl = gl(1285, k = 100)[1:128407]) |> #create factor levels to use group_split on"
"0","#   group_split(fl, .keep = FALSE)"
"0","# "
"0","# audio_features <- list()"
"0","# "
"0","# for (i in 1:length(track_id)) {"
"0","#   audio_features[[i]] <- spotifyr::get_track_audio_features(unlist(track_id[[i]]))"
"0","# }"
"0",""
"0","#saveRDS(audio_features, ""cache/audio_features.rds"")"
"0","audio_features <- readRDS(""cache/audio_features.rds"")"
"0",""
"0","audio_features <- data.table::rbindlist(audio_features) |>"
"0","  rename(track_id = id)"
"0",""
"0","spotify <- bind_cols(spotify, audio_features) |>"
"0","  select(-c(""track_id...24"")) |>"
"0","  rename(track_id = ""track_id...8"")"
"2","New names:
* track_id -> track_id...8
* track_id -> track_id...24
"
"0","#key, loudness, tempo, time signature are NOT 0 to 1 "
"0",""
"0","spotify <- spotify |>"
"0","  mutate(loudness_norm = (loudness - min(loudness))/(max(loudness)- min(loudness)), "
"0","         tempo_norm = (tempo - min(tempo))/(max(tempo)- min(tempo)), "
"0","         time_signature_norm = (time_signature - min(time_signature))/(max(time_signature) - min(time_signature))) |>"
"0","  select(-c(time, conn_country, reason_start, reason_end, type, uri, track_href, analysis_url, loudness, tempo, time_signature, speechiness)) |>"
"0","  filter(master_metadata_album_artist_name != ""Mark Williams"") |> #Meditation track"
"0","  relocate(17:19, .before = 16)"
"0",""
"0","#I am going to remove 'key', I don't think it makes sense to keep it in, even normalized."
